---
interface Props {
  currentDiscipline?: string;
  basePath?: string;
  preserveParams?: Record<string, string>;
}

const { currentDiscipline, basePath = '/articles', preserveParams = {} } = Astro.props;

const disciplines = [
  { value: '', label: 'All Disciplines' },
  { value: 'PM', label: 'Product Management' },
  { value: 'Design', label: 'Design' },
  { value: 'Engineering', label: 'Engineering' },
];
---

<div class="flex flex-wrap gap-2 mb-8">
  {
    disciplines.map((discipline) => {
      const params = new URLSearchParams();
      // Preserve other query params (e.g., level on books page)
      for (const [key, val] of Object.entries(preserveParams)) {
        if (val) params.set(key, val);
      }
      if (discipline.value) params.set('discipline', discipline.value);
      const href = params.toString() ? `${basePath}?${params.toString()}` : basePath;

      return (
        <a
          href={href}
          class:list={[
            'px-4 py-2 rounded-lg font-medium transition-colors',
            {
              'bg-blue-600 text-white':
                currentDiscipline === discipline.value ||
                (!currentDiscipline && !discipline.value),
              'bg-gray-200 text-gray-700 hover:bg-gray-300':
                currentDiscipline !== discipline.value && (currentDiscipline || discipline.value),
            },
          ]}
        >
          {discipline.label}
        </a>
      );
    })
  }
</div>
