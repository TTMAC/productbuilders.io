---
import type { CollectionEntry } from 'astro:content';
import { getDisciplineColor, getDisciplineLabel } from '../utils';
import RatingStars from './RatingStars.astro';

interface Props {
  book: CollectionEntry<'books'>;
}

const { book } = Astro.props;
const {
  title,
  bookAuthor,
  discipline,
  level,
  rating,
  publicationYear,
  whoShouldRead,
  keyTakeaways,
} = book.data;
---

<article class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
  <div class="p-6">
    <!-- Discipline badge, level badge, and year -->
    <div class="flex items-center gap-2 mb-3 flex-wrap">
      <span class={`badge-${getDisciplineColor(discipline)}`}>
        {getDisciplineLabel(discipline)}
      </span>
      <span class="badge-level">{level}</span>
      <span class="text-sm text-gray-500">{publicationYear}</span>
    </div>

    <!-- Rating -->
    <div class="mb-3">
      <RatingStars rating={rating} size="sm" />
    </div>

    <!-- Title -->
    <h3 class="text-xl font-bold text-gray-900 mb-1">
      <a href={`/books/${book.slug}`} class="hover:text-blue-600 transition-colors">
        {title}
      </a>
    </h3>

    <!-- Author -->
    <p class="text-sm text-gray-600 mb-3">By {bookAuthor}</p>

    <!-- Who should read (description) -->
    <p class="text-gray-600 mb-4 line-clamp-2">{whoShouldRead}</p>

    <!-- Footer meta -->
    <div class="flex items-center justify-between">
      <span class="text-sm text-gray-500">
        {keyTakeaways.length} key takeaway{keyTakeaways.length !== 1 ? 's' : ''}
      </span>
      <a
        href={`/books/${book.slug}`}
        class="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors"
      >
        Read review &rarr;
      </a>
    </div>
  </div>
</article>
